Method 1:

SET @total = (SELECT COUNT(*) FROM h1b_2015 WHERE status = 'CERTIFIED');
SELECT state as TOP_STATES,
       COUNT(*) AS NUMBER_CERTIFIED_APPLICATIONS,
       CONCAT(ROUND(100 * COUNT(*) / @total, 1), '%') AS PERCENTAGE
FROM h1b_2015
WHERE status = 'CERTIFIED'
GROUP BY state
ORDER BY NUMBER_CERTIFIED_APPLICATIONS DESC, TOP_STATES ASC
LIMIT 10

SET @total = (SELECT COUNT(*) FROM h1b_2015);
SELECT soc_name as TOP_OCCUPATIONS,
       COUNT(*) AS NUMBER_CERTIFIED_APPLICATIONS,
       CONCAT(ROUND(100 * COUNT(*) / @total, 1), '%') AS PERCENTAGE
FROM h1b_2015
WHERE status = 'CERTIFIED'
GROUP BY soc_name
ORDER BY NUMBER_CERTIFIED_APPLICATIONS DESC, TOP_OCCUPATIONS ASC
LIMIT 10


Method 2:

